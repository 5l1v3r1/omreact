(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{113:function(t,e,n){},120:function(t,e){},122:function(t,e){},146:function(t,e){},149:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),i=n(30),r=n.n(i),c=(n(72),n(32)),s=n(4),l=n(5),u=n(7),h=n(6),f=n(8),d=(n(34),function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(u.a)(this,Object(h.a)(e).call(this,t))).getStyle=function(t){return"You"===t?{backgroundColor:"#FFDAB9",overflowY:"auto",opacity:.75}:{backgroundColor:"#FFD700",overflowY:"auto",opacity:.75}},n.determineVisualContent=function(t,e){if("undefined"==typeof t||null==typeof t)return null;if(t.length<=0)return null;var a=t.split("/");return"files.catbox.moe"===a[2]||"i.imgur.com"===a[2]?"mp4"==(a=a[3].split("."))[1]||"webm"==a[1]||"avi"==a[1]||"ogg"==a[1]||"mpeg"==a[1]?o.a.createElement("div",null,o.a.createElement("br",null),o.a.createElement("video",{ref:function(t){n.vidRef=t},onLoadedMetadata:n.scrollToBottomVideo,controls:!0,autoplay:!0}," ",o.a.createElement("source",{src:t}))," "):"jpg"==a[1]||"jpeg"==a[1]||"png"==a[1]||"gif"==a[1]?o.a.createElement("div",null,o.a.createElement("br",null),o.a.createElement("img",{src:t,alt:"User Content"})):null:a[2]?void 0:null},n.hoverOn=function(){n.chatRef.style.opacity=1},n.hoverOff=function(){n.chatRef.style.opacity=.75},n.scrollToBottom=function(){n.chatRef.scrollIntoView({behavior:"smooth",block:"start"})},n.scrollToBottomVideo=function(){n.vidRef.scrollIntoView({behavior:"smooth",block:"start"})},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{onMouseEnter:this.hoverOn,onMouseLeave:this.hoverOff,style:this.getStyle(this.props.chatItems.user),ref:function(e){t.chatRef=e}},this.props.chatItems.user+": "+this.props.chatItems.message,this.determineVisualContent(this.props.chatItems.message))}}]),e}(a.Component)),p=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return this.props.chatMessages.map(function(t){return o.a.createElement(d,{key:t.id,chatItems:t})})}}]),e}(a.Component),m=n(31),g=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){if(m.initWorker({path:"./dist/openpgp.worker.min.js"}),"undefined"==typeof localStorage.publicKey||"undefined"==typeof localStorage.privateKey||"undefined"==typeof localStorage.pass){var t=new Uint32Array(4);window.crypto.getRandomValues(t),localStorage.pass=t[2].toString();var e={userIds:[{name:t[3].toString(),email:t[0]+"@"+t[1]+".com"}],numBits:2048,passphrase:localStorage.pass};m.generateKey(e).then(function(t){localStorage.setItem("privateKey",t.privateKeyArmored),localStorage.setItem("publicKey",t.publicKeyArmored)})}return null}}]),e}(a.Component),v=function(t){function e(){var t,n;Object(s.a)(this,e);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(u.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(o)))).state={content:""},n.onChange=function(t){return n.setState({content:t.target.value})},n.onSubmit=function(t){t.preventDefault(),n.props.createMessage("You",n.state.content),n.setState({content:"",user:"You"})},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("form",{onSubmit:this.onSubmit,style:{position:"fixed",bottom:"0",width:"100%"}},o.a.createElement("input",{type:"text",name:"title",style:{flex:"10",padding:"5px"},placeholder:"Type Message Here...",value:this.state.content,onChange:this.onChange}),o.a.createElement("input",{type:"submit",value:"submit",className:"btn",style:{flex:"1"}}))}}]),e}(a.Component),b=(n(90),function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(u.a)(this,Object(h.a)(e).call(this,t))).lineGradient=function(t,e,a,o,i,r){var c=n.ctx.createLinearGradient(t,e,a,o);return c.addColorStop(0,i),c.addColorStop(1,r),c},n.radialGradient=function(t,e,a,o,i,r,c,s){var l=n.ctx.createRadialGradient(t,e,a,o,i,r,c,s);return l.addColorStop(0,c),l.addColorStop(1,s),l},n.rand=function(t,e){return Math.ceil(Math.random()*(e-t)+t)},n.canvasSize=function(){n.canvasRef.width=n.state.width,n.canvasRef.height=n.state.height},n.fill=function(t){n.fillcolor=t},n.stroke=function(t){n.strokecolor=t},n.border=function(t){n.strokesize=t},n.rect=function(t,e,a,o){n.ctx.fillStyle=n.fillcolor,n.ctx.strokeStyle=n.strokecolor,n.ctx.lineWidth=n.strokesize,n.ctx.beginPath(),n.ctx.rect(t,e,a,o),n.ctx.fill(),n.ctx.stroke(),n.ctx.closePath()},n.circle=function(t,e,a){n.ctx.fillStyle=n.fillcolor,n.ctx.strokeStyle=n.strokecolor,n.ctx.lineWidth=n.strokesize,n.ctx.beginPath(),n.ctx.arc(t,e,a,0,2*Math.PI,!1),n.ctx.fill(),n.ctx.stroke(),n.ctx.closePath()},n.point=function(t,e){n.ctx.fillStyle=n.fillcolor,n.ctx.strokeStyle=n.strokecolor,n.ctx.lineWidth=n.strokeSize,n.ctx.beginPath(),n.ctx.rect(t,e,1,1),n.ctx.fill(),n.ctx.stroke(),n.ctx.closePath()},n.canvasBackgroundFill=function(){n.fill(n.lineGradient(n.state.width/1,0,n.state.width/2,1.3*n.state.height,"#200030","#9c046e")),n.rect(0,0,n.state.width,n.state.height)},n.stars=function(){n.stroke("#ffffff"),n.border(1.5*Math.min(n.state.width/1440,n.state.height/900));for(var t=0;t<n.state.width/1.5;t++)n.point(n.rand(0,n.state.width),n.rand(0,n.state.width));n.stroke("#ffffff00")},n.sun=function(){var t=400*Math.min(n.state.width/1440,n.state.height/900);n.fill(n.lineGradient(n.state.width/2,0,n.state.width/2,1.1*n.state.height,"#ff4400","#ffff00")),n.circle(n.state.width/2,n.state.height/2,t)},n.water=function(){n.fill(n.radialGradient(n.state.width/2,n.state.height*(2/3),n.state.width/1440*100,n.state.width/2,n.state.height*(2/3),n.state.height/900*600,"#002244cc","#000044cc")),n.rect(0,n.state.height*(2/3),n.state.width,n.state.height/3)},n.onResize=function(){n.setState({width:window.innerWidth,height:window.innerHeight}),n.canvasSize(),n.createCanvasBackground()},n.createCanvasBackground=function(){n.canvasBackgroundFill(),n.stars(),n.sun(),n.water()},n.fillcolor="#000000",n.strokecolor="#000000",n.strokesize="#000000",n.state={width:window.innerWidth,height:window.innerHeight},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){this.ctx=this.canvasRef.getContext("2d"),this.setState({width:window.innerWidth,height:window.innerHeight}),window.addEventListener("resize",this.onResize),this.onResize(),this.createCanvasBackground()}},{key:"componentDidUpdate",value:function(){this.createCanvasBackground()}},{key:"render",value:function(){var t=this;return o.a.createElement("canvas",{ref:function(e){t.canvasRef=e}})}}]),e}(a.Component)),y=(n(113),n(65)),w=n.n(y),k=n(66),S=n.n(k),O=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(u.a)(this,Object(h.a)(e).call(this,t))).submitButton=function(){console.log("Can Submit")},n.createPeer=function(t,e){var a=new w.a({initiator:t,trickle:!1,stream:e});return n.forceUpdate(),a.on("connect",function(){console.log("Successfully connected to peer!")}),a.on("data",function(t){t=JSON.parse(t);var e={id:n.state.chatMessages.length,user:t.user,message:t.message};n.setState({chatMessages:[].concat(Object(c.a)(n.state.chatMessages),[e])})}),a.on("stream",function(t){n.setState({peerStream:t}),n.peerRef.srcObject=n.state.peerStream,n.peerRef.onloaddedmetadata=n.peerRef.play()}),n.setState({peer:a}),a},n.createMessage=function(t,e){var a={id:n.state.chatMessages.length,user:t,message:e};n.setState({chatMessages:[].concat(Object(c.a)(n.state.chatMessages),[a])}),n.state.peer.send(JSON.stringify({user:"Anon",message:e}))},n.state={chatMessages:[],peerInfo:null,stream:null,peer:null,peerStream:null},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(e){t.clientRef.srcObject=e,t.clientRef.onloaddedmetadata=t.clientRef.play(),t.forceUpdate(),t.socketConnection(e)})}},{key:"socketConnection",value:function(t){var e=this,n=S.a.connect("https://vaporwaveom.herokuapp.com/");console.log("Connecting to server..."),n.on("peer",function(a){e.createPeer(a.initiator,t),console.log("Server told client to become initiator: "+a.initiator),a.initiator&&e.state.peer.on("signal",function(t){n.emit("initiatorData",t),console.log("Emitting Initiator data to Server...")})}),n.on("joinInitiator",function(t){if(console.log("Joinining the initiator..."),console.log(t.data),e.state.peer.signal(t.data),!t.initiator){var a=t.socketid;e.state.peer.on("signal",function(t){n.emit("backToInitiator",{socketid:a,data:t}),console.log("Recieving Initiator's Data..")})}}),n.on("toInitiatorFromServer",function(t){e.state.peer.signal(t.data),console.log("Connecting to Peer...")})}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{id:"videoChat"},o.a.createElement("h3",{id:"logo"},"\u30d1\u30e9\u30c9\u30c3\u30af\u30b9"),o.a.createElement("video",{ref:function(e){t.clientRef=e},controls:!0,muted:!0}),o.a.createElement("video",{ref:function(e){t.peerRef=e},controls:!0})),o.a.createElement("div",{id:"chatApp",class:"disableScrollbars"},o.a.createElement(p,{chatMessages:this.state.chatMessages,submit:this.submitButton})),o.a.createElement(v,{createMessage:this.createMessage,peer:this.peer}),o.a.createElement(g,null),o.a.createElement(b,null))}}]),e}(a.Component);r.a.render(o.a.createElement(O,null),document.getElementById("root"))},67:function(t,e,n){t.exports=n(149)},72:function(t,e,n){},94:function(t,e){},96:function(t,e){}},[[67,1,2]]]);
//# sourceMappingURL=main.a21333dd.chunk.js.map